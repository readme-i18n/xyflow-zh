---

description: 了解如何在流程中使用子流程将节点分组。
---

import { Callout } from 'nextra/components';
import { RemoteCodeViewer } from 'xy-shared/server';

# 子流程

<Callout type="info">
  **`parentNode`属性已弃用！** 从11.11.0版本开始，我们将`parentNode`选项重命名为`parentId`。旧属性仍受支持，但将在版本12中移除。
</Callout>

子流程是节点内部的流程。它可以是独立的流程，也可以是与父节点外部其他节点相连的流程。此功能也可用于节点分组。在本文档部分，我们将构建包含子流程的流程，并向您展示子节点特有的选项。

<Callout type="warning">
  <strong>节点顺序</strong>
  为确保正确处理，父节点必须出现在`nodes`/`defaultNodes`数组中其子节点之前。
</Callout>

### 添加子节点

若要将节点添加为另一个节点的子节点，需使用`parentId`选项（在先前版本中称为`parentNode`，完整选项列表可查阅[节点选项章节](/api-reference/types/node)）。设置后，子节点将相对于其父节点定位。位置`{ x: 0, y: 0 }`表示父节点的左上角。

本示例中，我们通过传递style选项来设置父节点的固定宽度和高度。此外，我们将子节点范围设为`'parent'`，确保子节点无法移出父节点。

<RemoteCodeViewer route="learn/sub-flows" framework="react" />

### 使用子节点特定选项

当移动父节点时，您会看到子节点也随之移动。通过 `parentId` 选项将节点添加为另一个节点的子节点，仅实现了一个功能：使其相对于父节点定位。从标记结构来看，子节点并非真正的子元素。您可以将子节点拖拽或定位到父节点之外（当未设置 `extent: 'parent'` 选项时），但当移动父节点时，子节点会随之移动。

在上面的示例中，我们为父节点使用了 `group` 类型，但您也可以使用任何其他类型。`group` 类型仅是一种便捷的节点类型，不附带任何连接手柄。

现在我们将添加更多节点和边。如您所见，我们可以在组内连接节点，并创建从子流程到外部节点的连接：

<RemoteCodeViewer route="learn/sub-flows-2" framework="react" />

### 边的渲染行为

默认情况下，边会在节点下方渲染，这一行为适用于普通节点和组节点。然而，连接到具有父节点的边会在节点上方渲染。

如果您想自定义边的 z-index，可以使用 `zIndex` 选项。例如：

```tsx
const defaultEdgeOptions = { zIndex: 1 };

<ReactFlow defaultEdgeOptions={defaultEdgeOptions} />;
```

这允许您根据需要将边渲染在节点上方或调整其堆叠顺序。

### 使用默认节点类型作为父节点

让我们移除节点 B 的标签并添加一些子节点。在这个示例中可以看到，
您也可以使用默认节点类型之一作为父节点。我们还将子节点
设置为 `draggable: false`，使其不再可拖动。

<RemoteCodeViewer route="learn/sub-flows-3" framework="react" />