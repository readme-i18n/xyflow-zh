---

description: æœ¬æŒ‡å—å°†å±•ç¤ºå¦‚ä½•ä¸ºä½ çš„æµç¨‹æ·»åŠ åŸºç¡€äº¤äº’åŠŸèƒ½ã€‚
---

import { Callout, Steps } from 'nextra/components';
import { RemoteCodeViewer } from 'xy-shared/server';

# æ·»åŠ äº¤äº’åŠŸèƒ½

æˆ‘ä»¬å·²ç»å®Œæˆäº†[ç¬¬ä¸€ä¸ªæµç¨‹](learn/concepts/building-a-flow)çš„æ„å»ºï¼Œç°åœ¨è®©æˆ‘ä»¬æ·»åŠ äº¤äº’åŠŸèƒ½ï¼Œä½¿ä½ å¯ä»¥é€‰æ‹©ã€æ‹–æ‹½å’Œåˆ é™¤èŠ‚ç‚¹ä¸è¿çº¿ã€‚

## å¤„ç†å˜æ›´äº‹ä»¶

é»˜è®¤æƒ…å†µä¸‹ï¼Œé™¤äº†å¤„ç†è§†å£å¤–ï¼ŒReact Flow ä¸ä¼šç®¡ç†ä»»ä½•å†…éƒ¨çŠ¶æ€æ›´æ–°ã€‚å°±åƒå¤„ç† HTML `<input />` å…ƒç´ ä¸€æ ·ï¼Œä½ éœ€è¦å‘ React Flow ä¼ é€’[äº‹ä»¶å¤„ç†å™¨](/api-reference/react-flow#event-handlers)æ‰èƒ½å°†è§¦å‘çš„å˜æ›´åº”ç”¨åˆ°ä½ çš„èŠ‚ç‚¹å’Œè¿çº¿ä¸Šã€‚

<Steps>
 ### å¯¼å…¥ä¾èµ–

ä¸ºäº†ç®¡ç†å˜æ›´ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ React Flow æä¾›çš„ `useState` å’Œä¸¤ä¸ªè¾…åŠ©å‡½æ•°ï¼š
[`applyNodeChanges`](/api-reference/utils/apply-node-changes) ä¸
[`applyEdgeChanges`](/api-reference/utils/apply-edge-changes)ã€‚é¦–å…ˆå¯¼å…¥è¿™äº›å‡½æ•°ï¼š

```jsx
import { useState, useCallback } from 'react';
import { ReactFlow, applyEdgeChanges, applyNodeChanges } from '@xyflow/react';
```

### å®šä¹‰èŠ‚ç‚¹ä¸è¾¹

éœ€è¦å®šä¹‰åˆå§‹çš„èŠ‚ç‚¹å’Œè¾¹æ•°æ®ï¼Œè¿™äº›å°†ä½œä¸ºæµç¨‹å›¾çš„èµ·ç‚¹ï¼š

```jsx
const initialNodes = [
  {
    id: 'n1',
    position: { x: 0, y: 0 },
    data: { label: 'Node 1' },
    type: 'input',
  },
  {
    id: 'n2',
    position: { x: 100, y: 100 },
    data: { label: 'Node 2' },
  },
];

const initialEdges = [
  {
    id: 'n1-n2',
    source: 'n1',
    target: 'n2',
  },
];
```

### åˆå§‹åŒ–çŠ¶æ€

åœ¨ç»„ä»¶ä¸­è°ƒç”¨ `useState` é’©å­æ¥ç®¡ç†èŠ‚ç‚¹å’Œè¾¹çš„çŠ¶æ€ï¼š

```jsx {2-3}
export default function App() {
  const [nodes, setNodes] = useState(initialNodes);
  const [edges, setEdges] = useState(initialEdges);

  return (
    <div style={{ height: '100%', width: '100%' }}>
      <ReactFlow>
        <Background />
        <Controls />
      </ReactFlow>
    </div>
  );
}
```

### æ·»åŠ äº‹ä»¶å¤„ç†å™¨

éœ€è¦åˆ›å»ºä¸¤ä¸ªäº‹ä»¶å¤„ç†å™¨ï¼š
[`onNodesChange`](/api-reference/react-flow#onnodeschange) å’Œ
[`onEdgesChange`](/api-reference/react-flow#onedgeschange)ã€‚å®ƒä»¬ä¼šåœ¨å…ƒç´ å‘ç”Ÿæ‹–æ‹½æˆ–åˆ é™¤ç­‰å˜æ›´æ—¶æ›´æ–°çŠ¶æ€ï¼š

```jsx
const onNodesChange = useCallback(
  (changes) => setNodes((nodesSnapshot) => applyNodeChanges(changes, nodesSnapshot)),
  [],
);
const onEdgesChange = useCallback(
  (changes) => setEdges((edgesSnapshot) => applyEdgeChanges(changes, edgesSnapshot)),
  [],
);
```

### ä¼ é€’ç»™ ReactFlow

å°†èŠ‚ç‚¹ã€è¾¹æ•°æ®å’Œäº‹ä»¶å¤„ç†å™¨ä¼ é€’ç»™ `<ReactFlow />` ç»„ä»¶ï¼š

```jsx {2-5}
<ReactFlow
  nodes={nodes}
  edges={edges}
  onNodesChange={onNodesChange}
  onEdgesChange={onEdgesChange}
  fitView
>
  <Background />
  <Controls />
</ReactFlow>
```

### äº¤äº’å¼æµç¨‹å›¾

å¤§åŠŸå‘Šæˆï¼ç°åœ¨ä½ å·²æ‹¥æœ‰ä¸€ä¸ªåŸºç¡€äº¤äº’å¼æµç¨‹å›¾ ğŸ‰

å½“æ‹–æ‹½æˆ–é€‰æ‹©èŠ‚ç‚¹æ—¶ï¼Œ`onNodesChange` å¤„ç†å™¨ä¼šè¢«è§¦å‘ã€‚`applyNodeChanges` å‡½æ•°åˆ©ç”¨è¿™äº›å˜æ›´äº‹ä»¶æ›´æ–°èŠ‚ç‚¹çŠ¶æ€ã€‚ä»¥ä¸‹æ˜¯å®Œæ•´æ•ˆæœï¼Œå°è¯•ç‚¹å‡»å¹¶æ‹–æ‹½èŠ‚ç‚¹ç§»åŠ¨ï¼Œè§‚å¯Ÿç•Œé¢å®æ—¶æ›´æ–°ï¼š

<RemoteCodeViewer
  route="learn/make-it-interactive-1"
  framework="react"
  aspectRatio="4"
/>

</Steps>

## è¿æ¥å¤„ç†

æœ€åç¼ºå¤±çš„éƒ¨åˆ†æ˜¯ï¼šå®ç°èŠ‚ç‚¹é—´çš„äº¤äº’å¼è¿æ¥ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ª [`onConnect`](/api-reference/react-flow#onconnect) å¤„ç†å‡½æ•°ã€‚

<Steps>
### åˆ›å»º `onConnect` å¤„ç†å‡½æ•°

å½“ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´å»ºç«‹æ–°è¿æ¥æ—¶ï¼Œç³»ç»Ÿä¼šè°ƒç”¨ `onConnect` å¤„ç†å‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ [`addEdge`](/api-reference/utils/add-edge) å·¥å…·å‡½æ•°æ¥åˆ›å»ºæ–°è¾¹å¹¶æ›´æ–°è¾¹æ•°ç»„ã€‚

```jsx
const onConnect = useCallback(
  (params) => setEdges((edgesSnapshot) => addEdge(params, edgesSnapshot)),
  [],
);
```

### ä¼ é€’ç»™ ReactFlow

ç°åœ¨æˆ‘ä»¬å¯ä»¥å°† `onConnect` å¤„ç†å‡½æ•°ä¼ é€’ç»™ `<ReactFlow />` ç»„ä»¶ï¼š

```jsx {6}
<ReactFlow
  nodes={nodes}
  edges={edges}
  onNodesChange={onNodesChange}
  onEdgesChange={onEdgesChange}
  onConnect={onConnect}
  fitView
>
  <Background />
  <Controls />
</ReactFlow>
```

### å¯è¿æ¥æµç¨‹å›¾

å°è¯•é€šè¿‡ä»ä¸€ä¸ªè¿æ¥æŸ„æ‹–åŠ¨åˆ°å¦ä¸€ä¸ªæ¥è¿æ¥ä¸¤ä¸ªèŠ‚ç‚¹ã€‚æ­¤æ—¶ä¼šè§¦å‘ `onConnect` å¤„ç†å‡½æ•°ï¼Œæ–°è¾¹å°†è¢«æ·»åŠ åˆ°æµç¨‹å›¾ä¸­ã€‚ğŸ¥³

<RemoteCodeViewer
  aspectRatio="4"
  route="learn/make-it-interactive-2"
  framework="react"
/>

</Steps>

## å®Œæ•´ä»£ç ç¤ºä¾‹ ğŸ

<RemoteCodeViewer route="learn/make-it-interactive-2" framework="react" />

è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿæ¯å½“ React Flow è§¦å‘å˜æ›´ï¼ˆèŠ‚ç‚¹åˆå§‹åŒ–ã€èŠ‚ç‚¹æ‹–æ‹½ã€è¾¹é€‰æ‹©ç­‰ï¼‰æ—¶ï¼Œç³»ç»Ÿä¼šè°ƒç”¨ `onNodesChange` å¤„ç†å‡½æ•°ã€‚æˆ‘ä»¬å¯¼å‡ºäº† `applyNodeChanges` å¤„ç†å‡½æ•°ï¼Œè¿™æ ·æ‚¨å°±æ— éœ€è‡ªè¡Œå¤„ç†å˜æ›´ã€‚`applyNodeChanges` å¤„ç†å‡½æ•°ä¼šè¿”å›æ›´æ–°åçš„èŠ‚ç‚¹æ•°ç»„ä½œä¸ºæ‚¨çš„æ–°èŠ‚ç‚¹æ•°ç»„ã€‚ç°åœ¨æ‚¨å·²æ‹¥æœ‰å…·å¤‡ä»¥ä¸‹åŠŸèƒ½çš„äº¤äº’å¼æµç¨‹å›¾ï¼š

- å¯é€‰æ‹©çš„èŠ‚ç‚¹å’Œè¾¹
- å¯æ‹–æ‹½çš„èŠ‚ç‚¹
- é€šè¿‡ä»ä¸€ä¸ªèŠ‚ç‚¹æ‰‹æŸ„æ‹–æ‹½åˆ°å¦ä¸€ä¸ªå®ç°èŠ‚ç‚¹è¿æ¥
- æŒ‰ä½ `shift` é”®å¯ç”¨å¤šé€‰åŒºåŸŸï¼ˆé»˜è®¤çš„ [`selectionKeyCode`](/api-reference/react-flow#selectionkeycode)ï¼‰
- æŒ‰ä½ `cmd` é”®è¿›è¡Œå¤šé€‰ï¼ˆé»˜è®¤çš„ [`multiSelectionKeyCode`](/api-reference/react-flow#multiselectionkeycode)ï¼‰
- æŒ‰ `backspace` é”®åˆ é™¤é€‰ä¸­å…ƒç´ ï¼ˆé»˜è®¤çš„ [`deleteKeyCode`](/api-reference/react-flow#deletekeycode)ï¼‰

è‹¥æƒ³ç›´æ¥å¼€å§‹åˆ›å»ºè‡ªå·±çš„åº”ç”¨ï¼Œå»ºè®®æŸ¥é˜…[è‡ªå®šä¹‰](/learn/customization)ç« èŠ‚ã€‚å¦åˆ™è¯·ç»§ç»­é˜…è¯»ä»¥äº†è§£æ›´å¤š React Flow çš„åŠŸèƒ½ç‰¹æ€§ã€‚