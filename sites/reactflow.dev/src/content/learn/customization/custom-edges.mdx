---

sidebarTitle: Edges
description: 与自定义节点类似，React Flow 中的自定义边部分本质上也是 React 组件。本指南将展示如何实现带有附加控件的自定义边。
---

import { Callout, Steps } from 'nextra/components';
import { Image } from 'xy-shared';
import { RemoteCodeViewer } from 'xy-shared/server';

# 自定义边

与[自定义节点](/learn/customization/custom-nodes)类似，React Flow 中的自定义边本质上也是 React 组件。这意味着您可以沿边渲染任意内容！本指南将展示如何实现带有附加控件的自定义边。关于自定义边可用属性的完整参考，请查阅[边类型](/api-reference/types/edge-props)文档。

## 基础自定义边

如果边无法在两个连接节点之间渲染路径，那么它对我们就毫无用处。这些路径始终基于 SVG，通常使用 [`<BaseEdge />`](/api-reference/components/base-edge) 组件进行渲染。为了计算实际要渲染的 SVG 路径，React Flow 提供了一些实用函数：

- [`getBezierPath`](/api-reference/utils/get-bezier-path)
- [`getSimpleBezierPath`](/api-reference/utils/get-simple-bezier-path)
- [`getSmoothStepPath`](/api-reference/utils/get-smooth-step-path)
- [`getStraightPath`](/api-reference/utils/get-straight-path)

我们将通过渲染源节点和目标节点之间的直线路径来开始构建自定义边。

<Steps>

### 创建组件

我们首先创建一个名为 `CustomEdge` 的新 React 组件。然后使用计算得到的路径渲染 [`<BaseEdge />`](/api-reference/components/base-edge) 组件。这样我们就获得了一个与内置默认[边类型](/api-reference/types/edge#default-edge-types) `"straight"` 行为相同的直线边。

```jsx
import { BaseEdge, getStraightPath } from '@xyflow/react';

export function CustomEdge({ id, sourceX, sourceY, targetX, targetY }) {
  const [edgePath] = getStraightPath({
    sourceX,
    sourceY,
    targetX,
    targetY,
  });

  return (
    <>
      <BaseEdge id={id} path={edgePath} />
    </>
  );
}
```

### 创建 `edgeTypes`

在组件外部，我们定义一个 `edgeTypes` 对象。将新边类型命名为 `"custom-edge"`，并将刚创建的 `CustomEdge` 组件分配给它。

```jsx
const edgeTypes = {
  'custom-edge': CustomEdge,
};
```

### 传递 `edgeTypes` 属性

要使用它，我们还需要更新 `<ReactFlow />` 组件上的 [`edgeTypes`](/api-reference/react-flow#edge-types) 属性。

```jsx "edgeTypes={edgeTypes}"
export function Flow() {
  return <ReactFlow edgeTypes={edgeTypes} />;
}
```

### 使用新边类型

定义完 `edgeTypes` 对象后，我们可以通过将边的 `type` 字段设置为 `"custom-edge"` 来使用自定义边。

```jsx {6}
const initialEdges = [
  {
    id: 'e1',
    source: 'n1',
    target: 'n2',
    type: 'custom-edge',
  },
];
```

### 包含自定义边的流程图

<RemoteCodeViewer route="learn/custom-edge" framework="react" />

</Steps>

## 自定义 SVG 边路径

如前所述，若要在 React Flow 中创建自定义边，必须使用上文讨论的四种路径生成函数之一（例如 [`getBezierPath`](/api-reference/utils/get-bezier-path)）。但如果需要实现正弦曲线边或其他特殊边类型，则需自行构建边路径。

从 [`getBezierPath`](/api-reference/utils/get-bezier-path) 等函数获取的边路径本质上是一个路径字符串，该字符串会传递给 `<BaseEdge />` 组件的 `path` 属性。它包含绘制路径所需的所有信息，包括起点位置、曲线转折点、终点位置等。例如两点 `(x1, y1)` 到 `(x2, y2)` 之间的简单直线路径字符串如下所示：

```jsx
M x1 y1 L x2 y2
```

SVG 路径是由 `M`、`L`、`Q` 等命令及其参数值组成的串联指令集。以下是部分常用命令及其参数说明：

- `M x1 y1` 为移动命令，将当前点移动到坐标 (x1, y1) 处
- `L x1 y1` 为画线命令，从当前点绘制直线至坐标 (x1, y1)
- `Q x1 y1 x2 y2` 为二次贝塞尔曲线命令，从当前点绘制曲线至坐标 (x2, y2)。其中 (x1, y1) 是控制点，决定曲线的弯曲程度

当我们需要为自定义边创建路径时，首先使用 `M` 命令将当前点移动到 `sourceX, sourceY`（这些坐标值通过自定义边组件的 props 获取）。然后根据所需的形状，我们会使用其他命令如 `L`（绘制直线）、`Q`（绘制曲线），最终在 `targetX, targetY`（同样通过组件 props 获取）处结束路径。

如需深入了解 SVG 路径，可访问 [SVG-Path-Editor](https://yqnn.github.io/svg-path-editor/)。该工具允许粘贴任意 SVG 路径，并通过直观的界面分析各个路径命令。

以下示例展示了两种自定义边路径：阶梯边和正弦曲线边。建议先研究较为简单的阶梯边来熟悉自定义 SVG 路径的创建，再学习正弦曲线边的实现方式。通过此示例，您将掌握为自定义边创建 SVG 路径的核心技能。

<RemoteCodeViewer route="learn/custom-edge-path" framework="react" />