---

description: "当你通过编程方式为节点添加或移除连接手柄，或更新节点手柄位置时，需要使用此钩子函数通知 React Flow。这将更新节点的内部尺寸，并在必要时重新定位画布上的手柄位置。"
---

# useUpdateNodeInternals()

[Source on GitHub](https://github.com/xyflow/xyflow/blob/main/packages/react/src/hooks/useUpdateNodeInternals.ts)

当你通过编程方式为节点添加或移除连接手柄，或更新节点手柄位置时，需要使用此钩子函数通知 React Flow。这将更新节点的内部尺寸，并在必要时重新定位画布上的手柄位置。

```jsx
import { useCallback, useState } from 'react';
import { Handle, useUpdateNodeInternals } from '@xyflow/react';

export default function RandomHandleNode({ id }) {
  const updateNodeInternals = useUpdateNodeInternals();
  const [handleCount, setHandleCount] = useState(0);
  const randomizeHandleCount = useCallback(() => {
    setHandleCount(Math.floor(Math.random() * 10));
    updateNodeInternals(id);
  }, [id, updateNodeInternals]);

  return (
    <>
      {Array.from({ length: handleCount }).map((_, index) => (
        <Handle
          key={index}
          type="target"
          position="left"
          id={`handle-${index}`}
        />
      ))}

      <div>
        <button onClick={randomizeHandleCount}>Randomize handle count</button>
        <p>There are {handleCount} handles on this node.</p>
      </div>
    </>
  );
}
```

## 签名

<APIDocs functionName="useUpdateNodeInternals" />

## 注意事项

- 该钩子只能在 [`<ReactFlowProvider />`](/api-reference/react-flow-provider) 或 [`<ReactFlow />`](/api-reference/react-flow) 组件的子组件中使用。