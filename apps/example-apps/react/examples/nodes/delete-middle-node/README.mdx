---

title: 删除中间节点
description: 移除节点而不中断流程
---

本示例展示如何从链式结构中删除中间节点时恢复被断开的连线。具体来说，如果我们有三个按顺序连接的节点 `a->b->c`，当删除中间节点 `b` 后，该示例演示如何最终得到 `a->c` 的连接关系。

实现这一功能需要利用以下关键点：

- [`onNodesDelete`](/api-reference/react-flow#event-onnodesdelete) 回调函数会在节点被删除时触发通知
- [`getConnectedEdges`](/api-reference/utils/get-connected-edges) 可获取节点作为源或目标的所有连接边
- [`getIncomers`](/api-reference/utils/get-incomers) 和 [`getOutgoers`](/api-reference/utils/get-outgoers) 可分别获取以该节点为目标或源的连接节点

综合运用这些方法，我们就能将被删除节点的所有连接节点重新连接到该节点原先连接的节点上。

<RemoteCodeViewer route="examples/nodes/delete-middle-node" framework="react" />

虽然这个示例代码不足20行，但包含许多需要消化的内容。让我们逐步解析：

- 我们的 `onNodesDelete` 回调函数接收一个参数 `deleted`，这是一个包含所有刚被删除节点的数组。如果选中单个节点并按删除键，`deleted` 将仅包含该节点；但若进行多选操作，`deleted` 会包含选区内的所有节点。

- 我们创建了一个新的边数组 `remainingEdges`，其中包含流程中与已删除节点无关的所有边。

- 我们通过 _flatMap_ 遍历 `incomers` 数组创建另一个边数组。这些节点作为源节点连接到被删除节点。对于每个这样的节点，我们创建一条新边，连接到 `outgoers` 数组中的每个节点，这些节点作为目标节点连接到被删除节点。

<Callout type="info">
为简洁起见，我们使用了对象解构并同时重命名变量绑定（例如 `({ id: source }) => ...)` 解构对象的 `id` 属性并将其绑定到名为 `source` 的新变量），但您无需这样做
</Callout>

## 快速参考

<Cards num={2}>
  <Cards.Card
    title="getConnectedEdges"
    href="/api-reference/utils/getConnectedEdges"
  />
  <Cards.Card title="getIncomers" href="/api-reference/utils/getIncomers" />
  <Cards.Card
    title="Array.prototype.flatMap"
    href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/flatMap"
    icon={<ArrowTopRightOnSquareIcon />}
  />
  <Cards.Card
    title="Destructuring assignment"
    href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment#assigning_to_new_variable_names"
    icon={<ArrowTopRightOnSquareIcon />}
  />
</Cards>